# Neural-Grid Standard Makefile
# "The only valid interface to the project"

.PHONY: init up down proto test lint verify clean help

# --- Configuration ---
# Replace these with your project specifics
PROJECT_NAME := my-project
BACKEND_DIR := backend
PROTO_SRC := proto
PROTO_OUT := $(BACKEND_DIR)/api/pb

# --- 1. Environment & Setup ---

help: ## Show this help message
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "\033[36m%-20s\033[0m %s\n", $$1, $$2}'

init: ## Initialize development environment (Tools, Hooks)
	@echo "ğŸ› ï¸  Initializing Development Environment..."
	@# Example: Check for uv/poetry/go etc.
	@command -v pre-commit >/dev/null 2>&1 || pip install pre-commit
	@pre-commit install
	@echo "âœ… Done! Environment is ready."

up: ## Start infrastructure (Docker)
	@echo "ğŸš€ Starting Infrastructure..."
	@docker-compose up -d --wait
	@echo "âœ… Infrastructure is UP."

down: ## Stop infrastructure
	@echo "ğŸ›‘ Stopping Infrastructure..."
	@docker-compose down -v
	@echo "âœ… Cleaned up."

# --- 2. Contract ---

proto: ## Generate code from contracts (Protobuf/OpenAPI)
	@echo "ğŸ“œ Generating Contract Code..."
	@# Add your generation command here
	@# protoc ...
	@echo "âœ… Generation complete."

# --- 3. Quality Assurance ---

lint: ## Run Code Linters
	@echo "ğŸ” Running Linters..."
	@# golangci-lint run ./... or ruff check .
	@echo "âœ… Lint check passed."

test: ## Run Unit & Integration Tests
	@echo "ğŸ§ª Running Tests..."
	@# go test ./... or pytest
	@echo "âœ… Tests passed."

# --- 4. The Gatekeeper ---

verify: up proto lint test ## Run full verification (Pre-Push Gate)
	@echo "ğŸ›¡ï¸  Full System Verification Passed."
